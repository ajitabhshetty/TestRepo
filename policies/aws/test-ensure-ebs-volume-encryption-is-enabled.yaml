policies:
  - name: test-cfb-aws-ec2-ensure-ebs-volume-encryption-is-enabled
    resource: aws.ebs
    mode:
      type: pull
    metadata:
      category: [ stacklet/aws/encryption ]
      compliance:
        - type: CIS
          version: 1.4.0
          control-mappings: [ '2.2.1' ]
      creator: Stacklet
      severity: high
      matter_assurance:
        control_id: CFB-AWS-EC2-728F7341-1475-4353-AE4F-2F07BB7381E0
        classification: consideration
        remediation_level: low
      recommended_actions:
        remediation:
          - name: AWS Docs
            description: |
              Review and encrypt EBS volumes.
            type: link
            content: https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html
    description: |
      This policy will identify EBS volumes which are not encrypted. Per AWS security best practices, all EBS volumes should be
      encrypted to ensure secure data storage and to help prevent unauthorized access.
    filters:
      - type: value
        key: Encrypted
        value: false
